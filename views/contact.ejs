<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Hostel Contacts & Support - Hostelia</title>
    <meta
      name="description"
      content="Contact hostel staff and submit help requests"
    />
    <meta
      name="keywords"
      content="hostel contacts, staff directory, help requests"
    />
    <meta name="author" content="Hostelia" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />

    <style>
      .gradient {
        background: linear-gradient(90deg, #004aad 0%, #cb6ce6 100%);
      }

      /* Interactive Card Styles */
      .card {
        width: 280px;
        height: 280px;
        background: white;
        border-radius: 32px;
        padding: 3px;
        position: relative;
        box-shadow: #604b4a30 0px 70px 30px -50px;
        transition: all 0.5s ease-in-out;
        margin: 0 auto;
      }

      .card .mail {
        position: absolute;
        right: 2rem;
        top: 1.4rem;
        background: transparent;
        border: none;
      }

      .card .mail svg {
        stroke: #004aad;
        stroke-width: 3px;
      }

      .card .mail svg:hover {
        stroke: #cb6ce6;
      }

      .card .profile-pic {
        position: absolute;
        width: calc(100% - 6px);
        height: calc(100% - 6px);
        top: 3px;
        left: 3px;
        border-radius: 29px;
        z-index: 1;
        border: 0px solid #fbb9b6;
        overflow: hidden;
        transition: all 0.5s ease-in-out 0.2s, z-index 0.5s ease-in-out 0.2s;
      }

      .card .profile-pic img {
        object-fit: cover;
        width: 100%;
        height: 100%;
        object-position: 0px 0px;
        transition: all 0.5s ease-in-out 0s;
      }

      .card .bottom {
        position: absolute;
        bottom: 3px;
        left: 3px;
        right: 3px;
        background: linear-gradient(90deg, #004aad 0%, #cb6ce6 100%);
        top: 80%;
        border-radius: 29px;
        z-index: 2;
        box-shadow: rgba(96, 75, 74, 0.1882352941) 0px 5px 5px 0px inset;
        overflow: hidden;
        transition: all 0.5s cubic-bezier(0.645, 0.045, 0.355, 1) 0s;
      }

      .card .bottom .content {
        position: absolute;
        top: 4.2rem; /* Increased to push content below hovered profile pic */
        bottom: 4.5rem;
        left: 1.5rem;
        right: 1.5rem;
        overflow-y: auto;
        padding-right: 0.2rem; /* Reduced padding slightly */
        /* Scrollbar styling for Webkit browsers */
        &::-webkit-scrollbar {
          width: 5px; /* Make scrollbar thinner */
        }
        &::-webkit-scrollbar-track {
          background: rgba(0, 0, 0, 0.05); /* Very light track */
          border-radius: 10px;
        }
        &::-webkit-scrollbar-thumb {
          background: linear-gradient(
            90deg,
            rgba(0, 74, 173, 0.5) 0%,
            rgba(203, 108, 230, 0.5) 100%
          ); /* Semi-transparent gradient */
          border-radius: 10px;
        }
        &::-webkit-scrollbar-thumb:hover {
          background: linear-gradient(
            90deg,
            #004aad 0%,
            #cb6ce6 100%
          ); /* Full color on hover */
        }
        /* Scrollbar styling for Firefox */
        scrollbar-width: thin;
        scrollbar-color: rgba(112, 89, 222, 0.5) rgba(0, 0, 0, 0.05); /* thumb and track color */
      }

      .card .bottom .content .name {
        display: block;
        font-size: 1.2rem;
        color: white;
        font-weight: bold;
      }

      .card .bottom .content .about-me {
        display: block;
        font-size: 0.9rem;
        color: white;
        margin-top: 1rem;
      }

      .card .bottom .bottom-bottom {
        position: absolute;
        bottom: 1rem;
        left: 1.5rem;
        right: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .card .bottom .bottom-bottom .social-links-container {
        display: flex;
        gap: 1rem;
      }

      .card .bottom .bottom-bottom .social-links-container svg {
        height: 20px;
        fill: white;
        filter: drop-shadow(0 5px 5px rgba(165, 132, 130, 0.1333333333));
      }

      .card .bottom .bottom-bottom .social-links-container svg:hover {
        fill: #f55d56;
        transform: scale(1.2);
      }

      .card .bottom .bottom-bottom .button {
        background: white;
        color: #004aad;
        border: none;
        border-radius: 20px;
        font-size: 0.6rem;
        padding: 0.4rem 0.6rem;
        box-shadow: rgba(165, 132, 130, 0.1333333333) 0px 5px 5px 0px;
      }

      .card .bottom .bottom-bottom .button:hover {
        background: #cb6ce6;
        color: white;
      }

      .card:hover {
        border-top-left-radius: 55px;
      }

      .card:hover .bottom {
        top: 20%;
        border-radius: 80px 29px 29px 29px;
        transition: all 0.5s cubic-bezier(0.645, 0.045, 0.355, 1) 0.2s;
      }

      .card:hover .profile-pic {
        width: 100px;
        height: 100px;
        aspect-ratio: 1;
        top: 10px;
        left: 10px;
        border-radius: 50%;
        z-index: 3;
        border: 7px solid #004aad;
        box-shadow: rgba(96, 75, 74, 0.1882352941) 0px 5px 5px 0px;
        transition: all 0.5s ease-in-out, z-index 0.5s ease-in-out 0.1s;
      }

      .card:hover .profile-pic:hover {
        transform: scale(1.3);
        border-radius: 0px;
      }

      .card:hover .profile-pic img {
        transform: scale(1.5);
        object-position: 0px 10px;
        transition: all 0.5s ease-in-out 0.5s;
      }

      /* Form styles */
      .form-input {
        transition: border-color 0.2s ease-in-out;
        background-color: #f3f4f6;
      }

      .form-input:focus {
        border-color: #004aad;
        box-shadow: 0 0 0 3px rgba(0, 74, 173, 0.2);
      }

      .badge {
        position: absolute;
        top: 8px;
        right: 8px;
        padding: 4px 8px;
        border-radius: 20px;
        font-size: 0.7rem;
        font-weight: 600;
        color: white;
        z-index: 10;
      }

      .badge-warden {
        background: linear-gradient(45deg, #004aad, #2d82b7);
      }

      .badge-admin {
        background: linear-gradient(45deg, #8c1bab, #cb6ce6);
      }

      .badge-support {
        background: linear-gradient(45deg, #107869, #25b79f);
      }

      /* Enhanced form styles */
      .contact-form-container {
        border-top: 5px solid #004aad;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
      }

      .contact-form-container:hover {
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
      }

      .form-input-field {
        border: 1px solid #d1d5db;
        color: #374151;
        background-color: #fff;
        transition: all 0.3s ease;
      }

      .form-input-field:focus {
        border-color: #004aad;
        box-shadow: 0 0 0 3px rgba(0, 74, 173, 0.1);
      }

      .form-input-field::placeholder {
        color: #9ca3af;
      }

      .form-label {
        color: #374151;
        font-weight: 500;
      }

      .form-select {
        color: #374151;
        background-color: #fff;
        border: 1px solid #d1d5db;
      }

      .form-select option {
        color: #374151;
      }

      .form-radio {
        cursor: pointer;
      }

      .form-radio-label {
        cursor: pointer;
      }

      .submit-button {
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .submit-button:after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0) 0%,
          rgba(255, 255, 255, 0.2) 50%,
          rgba(255, 255, 255, 0) 100%
        );
        transition: all 0.6s ease;
      }

      .submit-button:hover:after {
        left: 100%;
      }

      /* Responsive Styles */
      @media (max-width: 1024px) {
        .cards-container {
          grid-template-columns: 1fr 1fr !important;
        }
      }
      @media (max-width: 768px) {
        .cards-container {
          grid-template-columns: 1fr !important;
          gap: 1rem !important;
        }
        .card {
          margin-bottom: 1.5rem;
        }
        .help-form-section {
          padding: 1rem 0.5rem !important;
        }
        /* Move the info icon up on mobile */
        .contact-icon-up {
          margin-bottom: 1.5rem !important;
        }
        .contact-wave-up {
          margin-top: -3.5rem !important;
        }
      }
      @media (max-width: 480px) {
        .cards-container {
          gap: 0.5rem !important;
        }
        .card {
          padding: 0.5rem !important;
        }
        .help-form-section {
          padding: 0.5rem 0.2rem !important;
        }
        .form-input {
          font-size: 0.95rem;
        }
        .form-label {
          font-size: 0.95rem;
        }
      }
    </style>
  </head>
  <body
    class="leading-normal tracking-normal text-white gradient overflow-x-hidden"
    style="font-family: 'Source Sans Pro', sans-serif"
  >
    <%- include('partials/navbar.ejs', { loggedIn, user }) %>

    <!-- Hero Section -->
    <div class="pt-16 w-full overflow-x-hidden">
      <div
        class="container max-w-screen-lg mx-auto px-4 flex flex-col md:flex-row items-center"
      >
        <div
          class="flex flex-col w-full md:w-2/5 justify-center items-center md:items-start text-center md:text-left"
        >
          <h1
            class="my-4 text-2xl sm:text-3xl md:text-5xl font-bold leading-tight text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-pink-500 to-purple-600 w-full break-words"
          >
            Get Support & Contact Staff
          </h1>
          <p
            class="leading-normal text-base sm:text-lg md:text-2xl mb-8 w-full break-words"
          >
            Reach out to our hostel management team or submit a help request
          </p>
        </div>
        <div
          class="w-full md:w-3/5 py-6 text-center flex justify-center items-center"
        >
          <svg
            class="w-40 h-40 md:w-64 md:h-64 z-50 mx-auto mb-6 md:mb-0 max-w-full h-auto"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
              clip-rule="evenodd"
            ></path>
          </svg>
        </div>
      </div>
    </div>
    <div class="relative -mt-16 md:-mt-20 lg:-mt-32 w-full overflow-x-hidden">
      <svg
        viewBox="0 0 1428 174"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        class="w-full h-auto"
      >
        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <g
            transform="translate(-2.000000, 44.000000)"
            fill="#FFFFFF"
            fill-rule="nonzero"
          >
            <path
              d="M0,0 C90.7283404,0.927527913 147.912752,27.187927 291.910178,59.9119003 C387.908462,81.7278826 543.605069,89.334785 759,82.7326078 C469.336065,156.254352 216.336065,153.6679 0,74.9732496"
              opacity="0.100000001"
            ></path>
            <path
              d="M100,104.708498 C277.413333,72.2345949 426.147877,52.5246657 546.203633,45.5787101 C666.259389,38.6327546 810.524845,41.7979068 979,55.0741668 C931.069965,56.122511 810.303266,74.8455141 616.699903,111.243176 C423.096539,147.640838 250.863238,145.462612 100,104.708498 Z"
              opacity="0.100000001"
            ></path>
            <path
              d="M1046,51.6521276 C1130.83045,29.328812 1279.08318,17.607883 1439,40.1656806 L1439,120 C1271.17211,77.9435312 1140.17211,55.1609071 1046,51.6521276 Z"
              id="Path-4"
              opacity="0.200000003"
            ></path>
          </g>
          <g
            transform="translate(-4.000000, 76.000000)"
            fill="#FFFFFF"
            fill-rule="nonzero"
          >
            <path
              d="M0.457,34.035 C57.086,53.198 98.208,65.809 123.822,71.865 C181.454,85.495 234.295,90.29 272.033,93.459 C311.355,96.759 396.635,95.801 461.025,91.663 C486.76,90.01 518.727,86.372 556.926,80.752 C595.747,74.596 622.372,70.008 636.799,66.991 C663.913,61.324 712.501,49.503 727.605,46.128 C780.47,34.317 818.839,22.532 856.324,15.904 C922.689,4.169 955.676,2.522 1011.185,0.432 C1060.705,1.477 1097.39,3.129 1121.236,5.387 C1161.703,9.219 1208.621,17.821 1235.4,22.304 C1285.855,30.748 1354.351,47.432 1440.886,72.354 L1441.191,104.352 L1.121,104.031 L0.457,34.035 Z"
            ></path>
          </g>
        </g>
      </svg>
    </div>
    <section class="bg-white border-b py-12 w-full overflow-x-hidden">
      <div class="container max-w-screen-lg mx-auto px-4">
        <h2
          class="w-full my-2 text-4xl md:text-5xl font-bold leading-tight text-center text-gray-800"
        >
          Hostel Staff Directory
        </h2>
        <div class="w-full mb-4">
          <div
            class="h-1 mx-auto gradient w-64 opacity-25 my-0 py-0 rounded-t"
          ></div>
        </div>
        <p class="text-center text-gray-600 text-lg mb-12">
          Connect with our team for any assistance you need
        </p>
        <div
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-12 mx-auto mt-12 mb-12"
        >
          <div class="card">
            <span class="badge badge-warden">Chief Warden</span>
            <div class="profile-pic">
              <img src="/images/profile1.jpg" alt="Dr. Venkat Ramesh" />
            </div>
            <div class="bottom">
              <div class="content">
                <span class="name">Dr. V. Venkat Ramesh</span>
                <span class="about-me"
                  >Chief Warden at Hostelia. Responsible for student welfare,
                  discipline and overall hostel management.</span
                >
              </div>
              <div class="bottom-bottom">
                <div class="social-links-container">
                  <a
                    href="https://wa.me/9198765432"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#25D366"
                    >
                      <path
                        d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.296-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"
                      />
                    </svg>
                  </a>

                  <a href="tel:9198765432">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#007AFF"
                    >
                      <path
                        d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"
                      />
                    </svg>
                  </a>
                </div>
                <a
                  href="mailto:chief.warden@hostelia.edu"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="button"
                  >Email Me</a
                >
              </div>
            </div>
          </div>

          <div class="card">
            <span class="badge badge-warden">Deputy Warden</span>
            <div class="profile-pic">
              <img src="/images/profile2.jpg" alt="Dr. Samantha Patel" />
            </div>
            <div class="bottom">
              <div class="content">
                <span class="name">Dr. Samantha Patel</span>
                <span class="about-me"
                  >Deputy Warden overseeing female hostels, student activities
                  and welfare committees.</span
                >
              </div>
              <div class="bottom-bottom">
                <div class="social-links-container">
                  <a
                    href="https://wa.me/9187654321"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#25D366"
                    >
                      <path
                        d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.296-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"
                      />
                    </svg>
                  </a>

                  <a href="tel:9187654321">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#007AFF"
                    >
                      <path
                        d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"
                      />
                    </svg>
                  </a>
                </div>
                <a
                  href="mailto:deputy.warden@hostelia.edu"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="button"
                  >Email Me</a
                >
              </div>
            </div>
          </div>

          <div class="card">
            <span class="badge badge-admin">Admin</span>
            <div class="profile-pic">
              <img src="/images/profile1.jpg" alt="Mr. Rajesh Kumar" />
            </div>
            <div class="bottom">
              <div class="content">
                <span class="name">Mr. Rajesh Kumar</span>
                <span class="about-me"
                  >Administrative Officer handling admissions, fee collections,
                  and general administrative tasks.</span
                >
              </div>
              <div class="bottom-bottom">
                <div class="social-links-container">
                  <a
                    href="https://wa.me/9176543210"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#25D366"
                    >
                      <path
                        d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.296-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"
                      />
                    </svg>
                  </a>

                  <a href="tel:9176543210">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#007AFF"
                    >
                      <path
                        d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"
                      />
                    </svg>
                  </a>
                </div>
                <a
                  href="mailto:admin@hostelia.edu"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="button"
                  >Email Me</a
                >
              </div>
            </div>
          </div>

          <div class="card">
            <span class="badge badge-support">Maintenance</span>
            <div class="profile-pic">
              <img src="/images/profile2.jpg" alt="Mr. Prakash Singh" />
            </div>
            <div class="bottom">
              <div class="content">
                <span class="name">Mr. Prakash Singh</span>
                <span class="about-me"
                  >Maintenance Supervisor responsible for infrastructure
                  repairs, maintenance tasks and facility upkeep.</span
                >
              </div>
              <div class="bottom-bottom">
                <div class="social-links-container">
                  <a
                    href="https://wa.me/9165432109"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#25D366"
                    >
                      <path
                        d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.296-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"
                      />
                    </svg>
                  </a>

                  <a href="tel:9165432109">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#007AFF"
                    >
                      <path
                        d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"
                      />
                    </svg>
                  </a>
                </div>
                <a
                  href="mailto:maintenance@hostelia.edu"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="button"
                  >Email Me</a
                >
              </div>
            </div>
          </div>

          <div class="card">
            <span class="badge badge-support">Mess</span>
            <div class="profile-pic">
              <img src="/images/profile1.jpg" alt="Mrs. Lakshmi Devi" />
            </div>
            <div class="bottom">
              <div class="content">
                <span class="name">Mrs. Lakshmi Devi</span>
                <span class="about-me"
                  >Mess Manager handling meal planning, kitchen staff
                  management, and food quality oversight.</span
                >
              </div>
              <div class="bottom-bottom">
                <div class="social-links-container">
                  <a
                    href="https://wa.me/9154321098"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#25D366"
                    >
                      <path
                        d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.296-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"
                      />
                    </svg>
                  </a>

                  <a href="tel:9154321098">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#007AFF"
                    >
                      <path
                        d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"
                      />
                    </svg>
                  </a>
                </div>
                <a
                  href="mailto:mess@hostelia.edu"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="button"
                  >Email Me</a
                >
              </div>
            </div>
          </div>

          <div class="card">
            <span class="badge badge-support">Security</span>
            <div class="profile-pic">
              <img src="/images/profile2.jpg" alt="Mr. Suresh Babu" />
            </div>
            <div class="bottom">
              <div class="content">
                <span class="name">Mr. Suresh Babu</span>
                <span class="about-me"
                  >Chief Security Officer managing campus security, entry/exit
                  protocols, and emergency response.</span
                >
              </div>
              <div class="bottom-bottom">
                <div class="social-links-container">
                  <a
                    href="https://wa.me/9143210987"
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#25D366"
                    >
                      <path
                        d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.296-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"
                      />
                    </svg>
                  </a>

                  <a href="tel:9143210987">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="#007AFF"
                    >
                      <path
                        d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"
                      />
                    </svg>
                  </a>
                </div>
                <a
                  href="mailto:security@hostelia.edu"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="button"
                  >Email Me</a
                >
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="bg-gray-100 py-16">
      <div class="container max-w-7xl mx-auto m-8">
        <h2
          class="w-full my-2 text-4xl font-bold leading-tight text-center text-gray-800"
        >
          Submit a Help Request
        </h2>
        <div class="w-full mb-4">
          <div
            class="h-1 mx-auto gradient w-64 opacity-25 my-0 py-0 rounded-t"
          ></div>
        </div>
        <p class="text-center text-gray-600 text-lg mb-12">
          Need assistance? Fill out this form and we'll get back to you as soon
          as possible
        </p>

        <div
          class="max-w-3xl mx-auto bg-white rounded-lg contact-form-container overflow-hidden"
        >
          <div class="p-8">
            <form
              id="helpRequestForm"
              action="/submit-help-request"
              method="POST"
              class="space-y-6"
            >
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label
                    for="name"
                    class="block text-sm font-medium form-label mb-1"
                    >Full Name</label
                  >
                  <input type="text" id="name" name="name" minlength="3"
                  maxlength="50" required pattern="[A-Za-z\s]+" title="Please
                  enter a valid name (letters and spaces only)"
                  placeholder="Enter your full name" class="w-full px-4 py-2
                  border rounded-lg form-input-field focus:outline-none
                  focus:ring-2 focus:ring-indigo-500 <%= user && user.name ?
                  'bg-gray-200' : '' %>" value="<%= user && user.name ?
                  user.name : '' %>" <%= user && user.name ? 'readonly' : '' %>
                  />
                </div>
                <div>
                  <label
                    for="room"
                    class="block text-sm font-medium form-label mb-1"
                    >Room Number</label
                  >
                  <% if (user && user.role === 'admin') { %>
                  <input
                    type="text"
                    name="room"
                    id="room"
                    value=""
                    class="w-full px-4 py-2 border rounded-lg form-input-field bg-gray-100 text-gray-400"
                    placeholder="Not applicable for admins"
                    disabled
                  />
                  <% } else if (user && user.role === 'warden') { %>
                  <input
                    type="text"
                    name="room"
                    id="room"
                    value=""
                    class="w-full px-4 py-2 border rounded-lg form-input-field bg-gray-100 text-gray-400"
                    placeholder="Not applicable for wardens"
                    disabled
                  />
                  <% } else { %>
                  <input
                    type="text"
                    name="room"
                    id="room"
                    value="<%= user ? user.roomNumber : '' %>"
                    class="w-full px-4 py-2 border rounded-lg form-input-field"
                    placeholder="e.g. A-101"
                  />
                  <% } %>
                </div>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label
                    for="email"
                    class="block text-sm font-medium form-label mb-1"
                    >Email Address</label
                  >
                  <input type="email" id="email" name="email" required
                  pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
                  title="Please enter a valid email address" placeholder="Your
                  email address" class="w-full px-4 py-2 border rounded-lg
                  form-input-field focus:outline-none focus:ring-2
                  focus:ring-indigo-500 <%= user && user.email ? 'bg-gray-200' :
                  '' %>" value="<%= user && user.email ? user.email : '' %>" <%=
                  user && user.email ? 'readonly' : '' %> />
                </div>
                <div>
                  <label
                    for="phone"
                    class="block text-sm font-medium form-label mb-1"
                    >Phone Number</label
                  >
                  <input
                    type="tel"
                    id="phone"
                    name="phone"
                    required
                    pattern="[0-9]{10}"
                    title="Please enter a valid 10-digit phone number"
                    placeholder="Your contact number"
                    class="w-full px-4 py-2 border rounded-lg form-input-field focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    value=""
                  />
                </div>
              </div>

              <div>
                <label
                  for="hostel"
                  class="block text-sm font-medium form-label mb-1"
                  >Hostel Number</label
                >
                <% if (user && user.role === 'admin') { %>
                <input
                  type="text"
                  name="hostel"
                  id="hostel"
                  value=""
                  class="w-full px-4 py-2 border rounded-lg form-input-field bg-gray-100 text-gray-400"
                  placeholder="Not applicable for admins"
                  disabled
                />
                <% } else if (user && user.role === 'warden') { %>
                <input
                  type="text"
                  name="hostel"
                  id="hostel"
                  value="<%= user.hostelNumber %>"
                  class="w-full px-4 py-2 border rounded-lg form-input-field bg-gray-100"
                  readonly
                />
                <% } else { %>
                <input
                  type="text"
                  name="hostel"
                  id="hostel"
                  value="<%= user ? user.hostelNumber : '' %>"
                  class="w-full px-4 py-2 border rounded-lg form-input-field"
                  placeholder="e.g. H-5 or Block-C"
                />
                <% } %>
              </div>

              <div>
                <label
                  for="request_type"
                  class="block text-sm font-medium form-label mb-1"
                  >Request Type</label
                >
                <select
                  id="request_type"
                  name="request_type"
                  required
                  class="w-full px-4 py-2 border rounded-lg form-select focus:outline-none focus:ring-2 focus:ring-indigo-500"
                >
                  <option value="" disabled selected>
                    Select request type
                  </option>
                  <option value="maintenance">Maintenance Request</option>
                  <option value="cleaning">Cleaning Request</option>
                  <option value="facilities">Facilities Issue</option>
                  <option value="mess">Mess Related</option>
                  <option value="security">Security Concern</option>
                  <option value="other">Other</option>
                </select>
              </div>

              <div>
                <label
                  for="message"
                  class="block text-sm font-medium form-label mb-1"
                  >Describe Your Request</label
                >
                <textarea
                  id="message"
                  name="message"
                  rows="5"
                  required
                  minlength="10"
                  maxlength="500"
                  placeholder="Please provide details about your request or issue..."
                  class="w-full px-4 py-2 border rounded-lg form-input-field focus:outline-none focus:ring-2 focus:ring-indigo-500"
                ></textarea>
                <p class="text-sm text-gray-500 mt-1">
                  <span id="messageLength">0</span>/500 characters
                </p>
              </div>

              <div>
                <label
                  for="urgency"
                  class="block text-sm font-medium form-label mb-1"
                  >Urgency Level</label
                >
                <div class="flex items-center space-x-6">
                  <div class="flex items-center">
                    <input
                      type="radio"
                      id="low"
                      name="urgency"
                      value="low"
                      class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 form-radio"
                    />
                    <label
                      for="low"
                      class="ml-2 text-sm form-radio-label text-gray-700"
                      >Low</label
                    >
                  </div>
                  <div class="flex items-center">
                    <input
                      type="radio"
                      id="medium"
                      name="urgency"
                      value="medium"
                      class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 form-radio"
                      checked
                    />
                    <label
                      for="medium"
                      class="ml-2 text-sm form-radio-label text-gray-700"
                      >Medium</label
                    >
                  </div>
                  <div class="flex items-center">
                    <input
                      type="radio"
                      id="high"
                      name="urgency"
                      value="high"
                      class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 form-radio"
                    />
                    <label
                      for="high"
                      class="ml-2 text-sm form-radio-label text-gray-700"
                      >High</label
                    >
                  </div>
                </div>
              </div>

              <div id="formStatus" class="hidden"></div>

              <div>
                <button
                  type="submit"
                  id="submitBtn"
                  class="w-full py-3 px-4 bg-gradient-to-r from-blue-600 to-purple-500 text-white font-bold rounded-lg shadow-md hover:from-blue-700 hover:to-purple-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-300 submit-button"
                >
                  Submit Request
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

    <svg
      class="wave-top"
      viewBox="0 0 1439 147"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
    >
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g transform="translate(-1.000000, -14.000000)" fill-rule="nonzero">
          <g class="wave" fill="#f8fafc">
            <path
              d="M1440,84 C1383.555,64.3 1342.555,51.3 1317,45 C1259.5,30.824 1206.707,25.526 1169,22 C1129.711,18.326 1044.426,18.475 980,22 C954.25,23.409 922.25,26.742 884,32 C845.122,37.787 818.455,42.121 804,45 C776.833,50.41 728.136,61.77 713,65 C660.023,76.309 621.544,87.729 584,94 C517.525,105.104 484.525,106.438 429,108 C379.49,106.484 342.823,104.484 319,102 C278.571,97.783 231.737,88.736 205,84 C154.629,75.076 86.296,57.743 0,32 L0,0 L1440,0 L1440,84 Z"
            ></path>
          </g>
          <g transform="translate(1.000000, 15.000000)" fill="#FFFFFF">
            <g
              transform="translate(719.500000, 68.500000) rotate(-180.000000) translate(-719.500000, -68.500000) "
            >
              <path
                d="M0,0 C90.7283404,0.927527913 147.912752,27.187927 291.910178,59.9119003 C387.908462,81.7278826 543.605069,89.334785 759,82.7326078 C469.336065,156.254352 216.336065,153.6679 0,74.9732496"
                opacity="0.100000001"
              ></path>
              <path
                d="M100,104.708498 C277.413333,72.2345949 426.147877,52.5246657 546.203633,45.5787101 C666.259389,38.6327546 810.524845,41.7979068 979,55.0741668 C931.069965,56.122511 810.303266,74.8455141 616.699903,111.243176 C423.096539,147.640838 250.863238,145.462612 100,104.708498 Z"
                opacity="0.100000001"
              ></path>
              <path
                d="M1046,51.6521276 C1130.83045,29.328812 1279.08318,17.607883 1439,40.1656806 L1439,120 C1271.17211,77.9435312 1140.17211,55.1609071 1046,51.6521276 Z"
                opacity="0.200000003"
              ></path>
            </g>
          </g>
        </g>
      </g>
    </svg>

    <%- include('partials/footer.ejs') %>

    <script src="/js/navbar.js"></script>
    <script>
      var currentUserRole = "<%= user && user.role ? user.role : '' %>";
      var userName = "<%= user && user.name ? user.name : '' %>";
      var userEmail = "<%= user && user.email ? user.email : '' %>";
      var userRoomNumber =
        "<%= user && user.roomNumber ? user.roomNumber : '' %>";
      var userHostelNumber =
        "<%= user && user.hostelNumber ? user.hostelNumber : '' %>";
      var isLoggedIn =
        "<%= typeof user !== 'undefined' && user ? true : false %>" === "true";

      document.addEventListener("DOMContentLoaded", function () {
        const form = document.getElementById("helpRequestForm");
        const messageTextarea = document.getElementById("message");
        const messageLength = document.getElementById("messageLength");
        const formStatus = document.getElementById("formStatus");
        const submitBtn = document.getElementById("submitBtn");
        const requestTypeSelect = document.getElementById("request_type");

        // Autofilled fields - make them readonly in JS too if needed, though EJS should handle it
        const nameInput = document.getElementById("name");
        const roomInput = document.getElementById("room");
        const emailInput = document.getElementById("email");
        const phoneInput = document.getElementById("phone");
        const hostelNumberInput = document.getElementById("hostel");

        // Only make inputs readonly if user is logged in
        if (isLoggedIn) {
          if (nameInput && nameInput.value) nameInput.readOnly = true;
          if (emailInput && emailInput.value) emailInput.readOnly = true;

          if (currentUserRole === "student") {
            if (roomInput) roomInput.readOnly = true;
            if (hostelNumberInput) hostelNumberInput.readOnly = true;
          } else if (currentUserRole === "warden") {
            if (roomInput) roomInput.disabled = true;
            if (hostelNumberInput) hostelNumberInput.readOnly = true;
          }
        }

        // Phone input is always editable
        if (phoneInput) phoneInput.readOnly = false;

        // Set initial char count
        if (messageTextarea.value.length > 0) {
          messageLength.textContent = messageTextarea.value.length;
        }

        // Remove the "text-gray-400" class when an option is selected
        requestTypeSelect.addEventListener("change", function () {
          if (this.value !== "") {
            this.classList.remove("text-gray-400");
            this.classList.add("text-gray-700");
          }
        });

        // Update character count for message
        messageTextarea.addEventListener("input", function () {
          const length = this.value.length;
          messageLength.textContent = length;
          if (length > 500) {
            this.value = this.value.substring(0, 500);
            messageLength.textContent = 500;
          }
        });

        // Form submission handler
        form.addEventListener("submit", async function (e) {
          e.preventDefault();

          // Validate form
          if (!form.checkValidity()) {
            form.reportValidity();
            return;
          }

          // Show the form status element
          formStatus.classList.remove("hidden");
          formStatus.className =
            "p-4 mb-4 text-base flex items-center rounded-lg bg-blue-100 text-blue-800";
          formStatus.innerHTML = `
            <svg class="animate-spin mr-3 h-5 w-5 text-blue-700" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span>Processing your request...</span>
          `;

          // Disable submit button and show loading state
          submitBtn.disabled = true;
          submitBtn.innerHTML = `
            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            Submitting...
          `;

          try {
            const formData = new FormData(form);

            // Convert FormData to a plain object
            const formDataObj = {};
            formData.forEach((value, key) => {
              // For readonly fields, ensure their values are included from the input's value attribute
              if (
                document.getElementById(key) &&
                document.getElementById(key).readOnly
              ) {
                formDataObj[key] = document.getElementById(key).value;
              } else {
                formDataObj[key] = value;
              }
            });

            // Log the form data before sending
            console.log("Sending form data:", formDataObj);

            const response = await fetch("/submit-help-request", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(formDataObj),
            });

            const result = await response.json();

            if (response.ok) {
              // Show success message
              formStatus.className =
                "p-4 mb-4 text-base flex items-center rounded-lg bg-green-100 text-green-800";
              formStatus.innerHTML = `
                <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span>${result.message}</span>
              `;
              form.reset();
              messageLength.textContent = "0";

              // Reset the select color
              requestTypeSelect.classList.add("text-gray-400");
              requestTypeSelect.classList.remove("text-gray-700");

              if (isLoggedIn) {
                // Re-apply autofilled values after reset and ensure they are readonly
                if (nameInput && userName) {
                  nameInput.value = userName;
                  nameInput.readOnly = true;
                }

                if (emailInput && userEmail) {
                  emailInput.value = userEmail;
                  emailInput.readOnly = true;
                }

                if (currentUserRole === "student") {
                  if (roomInput && userRoomNumber) {
                    roomInput.value = userRoomNumber;
                    roomInput.readOnly = true;
                  }

                  if (hostelNumberInput && userHostelNumber) {
                    hostelNumberInput.value = userHostelNumber;
                    hostelNumberInput.readOnly = true;
                  }
                } else if (currentUserRole === "warden") {
                  if (roomInput) {
                    roomInput.value = "";
                    roomInput.disabled = true;
                    roomInput.placeholder = "Not applicable for Wardens";
                  }

                  if (hostelNumberInput && userHostelNumber) {
                    hostelNumberInput.value = userHostelNumber;
                    hostelNumberInput.readOnly = true;
                  }
                }
              }

              // Phone input is always cleared and editable
              if (phoneInput) {
                phoneInput.value = "";
                phoneInput.readOnly = false;
              }

              // Scroll to the status message
              formStatus.scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
            } else {
              throw new Error(result.message || "Failed to submit request");
            }
          } catch (error) {
            // Show error message
            formStatus.className =
              "p-4 mb-4 text-base flex items-center rounded-lg bg-red-100 text-red-800";
            formStatus.innerHTML = `
              <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
              </svg>
              <span>${error.message}</span>
            `;

            // Scroll to the status message
            formStatus.scrollIntoView({ behavior: "smooth", block: "center" });
          } finally {
            // Re-enable submit button
            submitBtn.disabled = false;
            submitBtn.innerHTML = "Submit Request";
          }
        });
      });
    </script>
  </body>
</html>
